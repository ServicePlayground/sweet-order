# Web-Seller 구현 현황 (기획자용)

## 📋 개요

Web-Seller는 Sweet Order 플랫폼의 판매자 관리 시스템입니다. 현재까지 구현된 주요 기능과 동작 방식을 정리합니다.

---

## 🔐 계정 및 인증 시스템

### 동일 계정 사용

- **Web-User와 Web-Seller는 동일한 계정을 사용합니다**
  - Web-User에서 회원가입한 계정으로 Web-Seller에 로그인할 수 있습니다
  - Web-Seller에서 회원가입한 계정으로 Web-User에 로그인할 수 있습니다
  - 두 플랫폼 모두 동일한 인증 API(`/v1/user/auth/login`)를 사용합니다

### 역할(Role) 자동 변경

- **스토어 생성 성공 시 자동으로 역할이 변경됩니다**
  - 초기 상태: 사용자는 `USER` 역할을 가집니다
  - 스토어 생성 완료 후: `USER` → `SELLER`로 자동 변경됩니다
  - 이미 `SELLER` 역할인 경우: 그대로 유지됩니다
  - 역할 변경 후: 판매자 기능(상품 등록 등)을 사용할 수 있습니다

---

## 🏪 스토어 등록 (3단계 프로세스)

스토어를 개설하기 위해서는 3단계 검증 과정을 거쳐야 합니다.

### 1단계: 사업자 정보 등록 및 진위확인

**목적**: 사업자등록번호가 정상적으로 등록되어 있고, 영업 중인 상태인지 확인합니다.

**사용자 입력 정보**:

- 사업자등록번호
- 대표자명
- 개업일자
- 상호명
- 업태명
- 종목명

**외부 API 연동**:

- **API 제공 기관**: 국세청
- **API 명세 URL**: https://www.data.go.kr/tcs/dss/selectApiDataDetailView.do?publicDataPk=15081808
- **전달하는 정보**:
  - 사업자등록번호 (하이픈 제거 후 전송)
  - 대표자명
  - 개업일자
  - 상호명
  - 업태명
  - 종목명

**검증 내용**:

- 사업자등록번호가 실제로 존재하는지 확인
- 입력한 정보(대표자명, 개업일자 등)가 실제 사업자 정보와 일치하는지 확인
- 사업 상태가 정상 영업 중인지 확인 (휴업/폐업 상태는 불가)

**성공 조건**:

- 사업자등록번호가 유효하고
- 입력한 정보가 실제 사업자 정보와 일치하며
- 사업 상태가 정상 영업 중인 경우

---

### 2단계: 통신판매사업자 정보 등록 및 확인

**목적**: 통신판매사업자로 등록되어 있고, 정상 영업 중인 상태인지 확인합니다.

**사용자 입력 정보**:

- 인허가관리번호 (통신판매사업자 신고번호)

**외부 API 연동**:

- **API 제공 기관**: 공정거래위원회
- **API 명세 URL**: https://www.data.go.kr/data/15126315/openapi.do
- **전달하는 정보**:
  - 사업자등록번호 (1단계에서 입력한 것과 동일, 하이픈 제거 후 전송)
  - 인허가관리번호 (통신판매사업자 신고번호)

**검증 내용**:

- 해당 사업자등록번호로 통신판매사업자 등록이 되어 있는지 확인
- 통신판매사업자 운영 상태가 "정상영업"인지 확인 (미등록/폐업/운영 불가 상태는 불가)

**성공 조건**:

- 통신판매사업자로 등록되어 있고
- 운영 상태가 "정상영업"인 경우

---

### 3단계: 스토어 정보 입력 및 생성

**목적**: 스토어의 기본 정보를 입력하고 최종적으로 스토어를 생성합니다.

**사용자 입력 정보**:

- 스토어 이름
- 스토어 설명
- 로고 이미지 URL
- 주소 정보 (도로명 주소, 지번 주소, 우편번호)
- 위치 정보 (위도, 경도)

**서버 검증 및 처리**:

1. **1단계와 2단계의 사업자등록번호 일치 확인**
   - 1단계에서 입력한 사업자등록번호와 2단계에서 사용한 사업자등록번호가 동일한지 확인
   - 하이픈을 제거한 후 비교하여 일치 여부를 확인합니다

2. **중복 스토어 생성 방지**
   - 같은 사용자가 동일한 사업자등록번호와 인허가관리번호 조합으로 이미 스토어를 만든 경우, 중복 생성을 방지합니다
   - 한 사용자는 여러 스토어를 만들 수 있지만, 같은 사업자 정보로는 중복 생성이 불가합니다

3. **1단계와 2단계 재검증**
   - 스토어 생성 시점에 1단계(사업자 진위확인)와 2단계(통신판매사업자 확인)를 다시 한 번 검증합니다
   - 이는 스토어 생성 시점의 최신 상태를 확인하기 위함입니다

4. **데이터 저장**
   - 사용자가 입력한 정보만 저장합니다
   - 외부 API에서 받은 응답 데이터(사업 상태, 세금 유형 등)는 저장하지 않습니다
   - 필요 시 언제든지 외부 API를 호출하여 최신 상태를 조회할 수 있습니다
   - 사업자등록번호는 하이픈을 제거한 형태로 저장하여 일관성을 유지합니다

5. **사용자 역할 자동 변경**
   - 스토어 생성이 완료되면 해당 사용자의 역할이 `USER`에서 `SELLER`로 자동 변경됩니다
   - 이미 `SELLER` 역할인 경우 그대로 유지됩니다

**성공 후 동작**:

- 스토어 생성 완료 알림이 표시됩니다
- 홈 페이지로 자동 이동합니다
- 이제 판매자 기능(상품 등록 등)을 사용할 수 있습니다

---

## 📊 데이터 저장 원칙

### 저장하는 정보

- 사용자가 직접 입력한 정보만 저장합니다
  - 사업자등록번호, 대표자명, 개업일자, 상호명, 업태명, 종목명
  - 인허가관리번호
  - 스토어 이름, 설명, 로고 이미지 URL, 주소 정보, 위치 정보

### 저장하지 않는 정보

- 외부 API에서 받은 응답 데이터는 저장하지 않습니다
  - 사업 상태 정보
  - 세금 유형 정보
  - 통신판매사업자 상세 정보 등
  - 위치
- 필요 시 언제든지 외부 API를 호출하여 최신 상태를 조회할 수 있습니다
