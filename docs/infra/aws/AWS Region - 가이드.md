# AWS 리전 선택 가이드

## 🧭 개요

본 문서는 SweetOrder 프로젝트의 클라우드 인프라(AWS) 구성 시  
**왜 `Asia Pacific (Tokyo)` 리전(ap-northeast-1)** 을 최종 선택했는지를 정리한 가이드입니다.  
RDS, App Runner, S3 등 주요 서비스를 모두 동일 리전에 두는 것이 기본 원칙입니다.

---

## 1️⃣ 리전 선택의 중요성

리전 선택은 단순히 “서버 위치” 문제가 아니라  
다음 항목 전체에 영향을 미칩니다.

| 항목                     | 영향 내용                             |
| ------------------------ | ------------------------------------- |
| ⚡ **Latency(지연속도)** | 사용자 → 서버 간 네트워크 왕복 시간   |
| 💰 **비용 구조**         | 리전별 인스턴스 단가, 전송 요금       |
| 🔒 **보안·법적 요건**    | 데이터 주권, 개인정보 보호 규정       |
| 🔄 **서비스 지원 여부**  | App Runner, RDS, S3 등 기능 제공 범위 |
| 🧱 **인프라 단순성**     | 여러 리전 혼합 시 관리 복잡도 증가    |

---

## 2️⃣ SweetOrder의 인프라 구성 요구사항

| 구분           | 요구사항                                     |
| -------------- | -------------------------------------------- |
| 대상 사용자    | 한국 및 동아시아권 사용자                    |
| 배포 형태      | AWS App Runner (서버리스 컨테이너)           |
| 데이터베이스   | AWS RDS for PostgreSQL                       |
| 파일 스토리지  | AWS S3                                       |
| 운영 방식      | staging / production 분리, 동일 리전 내 구성 |
| 우선 고려 기준 | **지연 속도와 App Runner 지원 여부**         |

---

## 3️⃣ 주요 후보 리전 비교

| 리전                              | App Runner 지원 | 평균 네트워크 지연(한국→AWS) | RDS 요금 (t3.micro/hr) | 특징                           |
| --------------------------------- | --------------- | ---------------------------- | ---------------------- | ------------------------------ |
| 🇰🇷 **Seoul (ap-northeast-2)**     | ❌ 미지원       | **10~20ms (최저)**           | $0.0264                | 빠르지만 App Runner 사용 불가  |
| 🇯🇵 **Tokyo (ap-northeast-1)**     | ✅ 지원         | **40~60ms (양호)**           | $0.0256                | App Runner 지원 + 지연 짧음    |
| 🇸🇬 **Singapore (ap-southeast-1)** | ✅ 지원         | 80~100ms                     | $0.0244                | 중간 정도 거리, 가격 준수      |
| 🇮🇪 **Ireland (eu-west-1)**        | ✅ 지원         | 200ms 이상                   | $0.0208                | 저렴하지만 거리 멀고 응답 느림 |
| 🇸🇪 **Stockholm (eu-north-1)**     | ❌ 미지원       | 220ms 이상                   | **$0.0188 (최저가)**   | 가장 싸지만 App Runner 불가    |

---

## 4️⃣ 도쿄 리전 선택 근거

### ✅ ① App Runner 지원 리전 중 가장 가까운 위치

- 한국과 지리적으로 근접 (동아시아 동일 타임존)
- 평균 지연 40~60ms 수준 → 실제 API 응답체감 빠름
- CloudFront/CDN 없이도 초기 서비스 단계에서 충분한 속도 확보

### ✅ ② RDS·S3·App Runner 모두 완전 지원

- **App Runner 지원 리전** 중 가장 안정적 (2025년 현재)
- RDS (PostgreSQL 16.x), S3, Secrets Manager, CloudWatch 등 모두 가용
- 하나의 리전 안에서 모든 핵심 서비스를 구성 가능 → 네트워크 비용 0원

### ✅ ③ 관리 효율성과 단순성

- 리전을 통일하면 다음 이점이 있음:
  - 서비스 간 **Cross-Region 통신비(GB당 $0.09)** 발생하지 않음
  - 보안 그룹, IAM 정책, Secrets Manager, CloudWatch 모두 단일 리전에서 관리 가능
  - staging / production 간 인프라 복제도 용이 (동일 리전 내 분리)

### ✅ ④ 성능 vs 비용 균형

| 리전                 | 총 인프라 비용 (App Runner + RDS + S3) 대비 |
| -------------------- | ------------------------------------------- |
| 아일랜드(eu-west-1)  | 100% (기준치)                               |
| 도쿄(ap-northeast-1) | 약 **115~120%**                             |
| 스톡홀름(eu-north-1) | 약 **95%**, 그러나 App Runner 불가          |

→ 약 15% 비용 증가로 **지연 4배 감소 + 관리 단순화 + App Runner 사용 가능**  
→ 실질적 효율성 관점에서 도쿄 리전이 가장 합리적

---

## 5️⃣ 리전 혼합 배포의 비효율성 (반례)

| 항목                                  | 문제점                                            |
| ------------------------------------- | ------------------------------------------------- |
| App Runner(아일랜드) ↔ RDS(스톡홀름) | 리전 간 전송비 발생 ($0.09/GB)                    |
| App Runner ↔ RDS 통신                | 지연 200ms 이상, DB 트랜잭션 병목                 |
| 모니터링 / 백업 / IAM                 | 리전별 설정 분리 → 관리 복잡                      |
| 장애 시 복구                          | 리전 간 스냅샷 복원 느림 (Cross-region copy 필요) |

> 결론적으로, **App Runner·RDS·S3를 모두 동일 리전에 두는 것이 원칙**이다.

---

## 6️⃣ 장기 확장성 측면

- 추후 App Runner의 **Auto Scaling**, **Custom Domain(ACM)**,  
  **VPC Connector(RDS Private Access)** 등을 확장하기 쉽다.
- 일본 리전은 **국내 트래픽과 국제 트래픽 모두 안정적 라우팅**이 가능해  
  아시아 전체 사용자 확장 시에도 유리.

---

## 🧾 최종 결정

> SweetOrder 프로젝트의 AWS 인프라는  
> **`Asia Pacific (Tokyo)` 리전 (ap-northeast-1)** 으로 통일한다.

### 구성 요약

| 서비스            | 리전           | 비고                                   |
| ----------------- | -------------- | -------------------------------------- |
| App Runner        | ap-northeast-1 | 백엔드 배포 (VPC Connector로 RDS 연결) |
| RDS (PostgreSQL)  | ap-northeast-1 | Private subnet, App Runner와 동일 VPC  |
| S3                | ap-northeast-1 | 이미지, 첨부 파일 저장소               |
| Secrets Manager   | ap-northeast-1 | DB 자격증명 관리                       |
| CloudWatch / Logs | ap-northeast-1 | 모니터링 통합                          |

---

## 📌 부록: 향후 리전 전략 참고

- 추후 **서울 리전(ap-northeast-2)** 에서 App Runner가 공식 지원되면  
  **전체 인프라를 서울로 마이그레이션** 하는 것을 고려할 수 있다.
- 리전 전환 시에는 RDS Snapshot → Copy → Restore,  
  S3 Cross-Region Replication 등을 사용하면 downtime 최소화 가능.

---

**작성자:** 박근우 (Geunwoo Park)  
**작성일:** 2025-10-10  
**문서 목적:** SweetOrder AWS 인프라 리전 결정 근거 공유용
