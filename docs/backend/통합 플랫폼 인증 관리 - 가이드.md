# í†µí•© í”Œë«í¼ ì¸ì¦ ê´€ë¦¬ ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”

Sweet Order í”Œë«í¼ì˜ í†µí•© ì¸ì¦ ì‹œìŠ¤í…œì€ 3-way ë¶„ë¦¬ëœ API êµ¬ì¡°(User, Seller, Admin)ì—ì„œ ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´ë¥¼ ì œê³µí•©ë‹ˆë‹¤. í•˜ë‚˜ì˜ í†µí•©ëœ `@Auth` ë°ì½”ë ˆì´í„°ë¥¼ í†µí•´ ëª¨ë“  ì¸ì¦ê³¼ ê¶Œí•œì„ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ğŸ¯ ì£¼ìš” íŠ¹ì§•

- **3-way API ë¶„ë¦¬**: User, Seller, Admin ì—­í• ë³„ ë…ë¦½ì ì¸ API
- **í†µí•© ì¸ì¦ ì‹œìŠ¤í…œ**: JWT + Google OAuth + íœ´ëŒ€í° ì¸ì¦
- **ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´**: USER, SELLER, ADMIN ì—­í•  êµ¬ë¶„
- **í•˜ë‚˜ì˜ ë°ì½”ë ˆì´í„°ë¡œ ëª¨ë“  ì¸ì¦/ê¶Œí•œ ì²˜ë¦¬**
- **Public ì—”ë“œí¬ì¸íŠ¸ ì§€ì›**
- **Swagger ìë™ ì¸ì¦ í—¤ë” í‘œì‹œ**
- **ê³„ì • ì—°ê²° ì‹œìŠ¤í…œ**: ì¼ë°˜ + êµ¬ê¸€ ê³„ì • ìë™ ì—°ê²°

## â­ ê¶Œì¥ ì‚¬ìš©ë²•

- **`@Auth({ isPublic: true })`**: ì¸ì¦ ì—†ì´ ì ‘ê·¼ ê°€ëŠ¥í•œ ì—”ë“œí¬ì¸íŠ¸
- **`@Auth({ isPublic: false })`**: ê¸°ë³¸ ì¸ì¦ (ëª¨ë“  ì¸ì¦ëœ ì‚¬ìš©ì)
- **`@Auth({ isPublic: false, roles: ['USER'] })`**: USER ì—­í• ë§Œ ì ‘ê·¼ ê°€ëŠ¥
- **`@Auth({ isPublic: false, roles: ['SELLER'] })`**: SELLER ì—­í• ë§Œ ì ‘ê·¼ ê°€ëŠ¥
- **`@Auth({ isPublic: false, roles: ['ADMIN'] })`**: ADMIN ì—­í• ë§Œ ì ‘ê·¼ ê°€ëŠ¥
- **`@Auth({ isPublic: false, roles: ['SELLER', 'ADMIN'] })`**: SELLERì™€ ADMIN ì—­í• ë§Œ ì ‘ê·¼ ê°€ëŠ¥

## ğŸ”§ ì‚¬ìš©ë²•

### 1. ê¸°ë³¸ ì‚¬ìš©ë²•

```typescript
import { Auth } from "@apps/backend/modules/auth/decorators/auth.decorator";

@Controller("example")
export class ExampleController {
  // ì¸ì¦ ì—†ì´ ì ‘ê·¼ ê°€ëŠ¥
  @Get("public")
  @Auth({ isPublic: true })
  async getPublicData() {
    return { message: "ê³µê°œ ë°ì´í„°" };
  }

  // ëª¨ë“  ì¸ì¦ëœ ì‚¬ìš©ì ì ‘ê·¼ ê°€ëŠ¥
  @Get("authenticated")
  @Auth({ isPublic: false })
  async getAuthenticatedData(@Request() req: { user: JwtVerifiedPayload }) {
    return { message: "ì¸ì¦ëœ ì‚¬ìš©ì ë°ì´í„°", user: req.user };
  }

  // USER ì—­í• ë§Œ ì ‘ê·¼ ê°€ëŠ¥
  @Get("user-only")
  @Auth({ isPublic: false, roles: ["USER"] })
  async getUserData(@Request() req: { user: JwtVerifiedPayload }) {
    return { message: "ì‚¬ìš©ì ì „ìš© ë°ì´í„°", user: req.user };
  }

  // SELLER ì—­í• ë§Œ ì ‘ê·¼ ê°€ëŠ¥
  @Get("seller-only")
  @Auth({ isPublic: false, roles: ["SELLER"] })
  async getSellerData(@Request() req: { user: JwtVerifiedPayload }) {
    return { message: "íŒë§¤ì ì „ìš© ë°ì´í„°", user: req.user };
  }

  // ADMIN ì—­í• ë§Œ ì ‘ê·¼ ê°€ëŠ¥
  @Get("admin-only")
  @Auth({ isPublic: false, roles: ["ADMIN"] })
  async getAdminData(@Request() req: { user: JwtVerifiedPayload }) {
    return { message: "ê´€ë¦¬ì ì „ìš© ë°ì´í„°", user: req.user };
  }

  // SELLERì™€ ADMIN ì—­í• ë§Œ ì ‘ê·¼ ê°€ëŠ¥
  @Get("seller-or-admin")
  @Auth({ isPublic: false, roles: ["SELLER", "ADMIN"] })
  async getSellerOrAdminData(@Request() req: { user: JwtVerifiedPayload }) {
    return { message: "íŒë§¤ì/ê´€ë¦¬ì ë°ì´í„°", user: req.user };
  }
}
```

## ğŸ¯ ì¥ì 

1. **ì½”ë“œ ê°„ì†Œí™”**: í•˜ë‚˜ì˜ ë°ì½”ë ˆì´í„°ë¡œ ëª¨ë“  ì¸ì¦/ê¶Œí•œ ì²˜ë¦¬
2. **ê°€ë…ì„± í–¥ìƒ**: ì—­í• ë³„ ì ‘ê·¼ ì œì–´ê°€ ëª…í™•í•˜ê²Œ í‘œí˜„ë¨
3. **ìœ ì§€ë³´ìˆ˜ì„±**: ì¸ì¦ ë¡œì§ì´ ì¤‘ì•™ ì§‘ì¤‘í™”ë¨
4. **í™•ì¥ì„±**: ìƒˆë¡œìš´ ì—­í• ì´ë‚˜ ê¶Œí•œ ì¶”ê°€ê°€ ìš©ì´í•¨
5. **ì¼ê´€ì„±**: ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë™ì¼í•œ íŒ¨í„´ ì‚¬ìš©

## ğŸ“š ì°¸ê³ ì‚¬í•­

- ëª¨ë“  ë°ì½”ë ˆì´í„°ëŠ” `@apps/backend/modules/auth/decorators/auth.decorator`ì—ì„œ import
- `JwtVerifiedPayload` íƒ€ì…ì„ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ì ì •ë³´ ì ‘ê·¼
- Swagger ë¬¸ì„œì—ì„œ ìë™ìœ¼ë¡œ ì¸ì¦ í—¤ë”ê°€ í‘œì‹œë¨
- Public ì—”ë“œí¬ì¸íŠ¸ëŠ” ì¸ì¦ ì—†ì´ ì ‘ê·¼ ê°€ëŠ¥
- `@Auth()` ì¸ì ì—†ì´ ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ - `isPublic` í•„ìˆ˜ ì…ë ¥
